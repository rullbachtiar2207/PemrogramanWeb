<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kontak - Jasa Fotografer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="index.html">Beranda</a></li>
                <li><a href="about.html">Tentang Kami</a></li>
                <li><a href="services.html">Layanan</a></li>
                <li><a href="contact.html">Kontak</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="hero">
            <h1>Kontak Kami</h1>
            <p>Hubungi kami untuk informasi lebih lanjut atau untuk pemesanan jasa fotografi.</p>
        </section>

        <!-- Formulir untuk menambah klien baru -->
        <section class="add-client">
            <h2>Tambah Klien Baru</h2>
            <form id="add-client-form">
                <label for="name">Nama:</label>
                <input type="text" id="name" name="name" required>

                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>

                <label for="message">Pesan:</label>
                <textarea id="message" name="message" required></textarea>

                <button type="submit">Tambah Klien</button>
            </form>
        </section>

        <!-- Daftar Klien -->
        <section class="client-list">
            <h2>Daftar Klien</h2>
            <table id="client-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nama</th>
                        <th>Email</th>
                        <th>Pesan</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data klien akan dimasukkan di sini -->
                </tbody>
            </table>
        </section>

        <!-- Formulir untuk memperbarui klien -->
        <section class="update-client">
            <h2>Perbarui Klien</h2>
            <form id="update-client-form" style="display: none;">
                <input type="hidden" id="update-id">
                <label for="update-name">Nama:</label>
                <input type="text" id="update-name" name="name" required>

                <label for="update-email">Email:</label>
                <input type="email" id="update-email" name="email" required>

                <label for="update-message">Pesan:</label>
                <textarea id="update-message" name="message" required></textarea>

                <button type="submit">Perbarui Klien</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Jasa Fotografer</p>
    </footer>

    <script>
        // Fungsi untuk memuat daftar klien
        function loadClients() {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', 'http://localhost:8000/clients', true);  // Ganti dengan URL API Anda
            xhr.onload = function() {
                if (xhr.status >= 200 && xhr.status < 300) {
                    var clients = JSON.parse(xhr.responseText);
                    var tableBody = document.getElementById('client-table').getElementsByTagName('tbody')[0];
                    tableBody.innerHTML = '';  // Bersihkan tabel sebelum menambah data baru

                    clients.forEach(function(client) {
                        var row = tableBody.insertRow();
                        row.innerHTML = `
                            <td>${client.id}</td>
                            <td>${client.name}</td>
                            <td>${client.email}</td>
                            <td>${client.message}</td>
                            <td>
                                <button onclick="editClient(${client.id})">Edit</button>
                                <button onclick="deleteClient(${client.id})">Hapus</button>
                            </td>
                        `;
                    });
                }
            };
            xhr.onerror = function() {
                console.error('Request failed');
            };
            xhr.send();
        }

        // Menangani pengiriman formulir untuk menambah klien baru
        document.getElementById('add-client-form').addEventListener('submit', function(event) {
            event.preventDefault();  // Mencegah reload halaman

            var name = document.getElementById('name').value;
            var email = document.getElementById('email').value;
            var message = document.getElementById('message').value;

            var xhr = new XMLHttpRequest();
            xhr.open('POST', 'http://localhost:8000/clients', true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onload = function() {
                if (xhr.status >= 200 && xhr.status < 300) {
                    alert('Klien berhasil ditambahkan!');
                    loadClients();  // Muat ulang daftar klien
                }
            };
            xhr.onerror = function() {
                console.error('Request failed');
            };

            // Kirimkan data ke API dalam format JSON
            var data = JSON.stringify({ name: name, email: email, message: message });
            xhr.send(data);
        });

        // Fungsi untuk mengedit klien
        function editClient(id) {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', 'http://localhost:8000/clients/' + id, true);
            xhr.onload = function() {
                if (xhr.status >= 200 && xhr.status < 300) {
                    var client = JSON.parse(xhr.responseText);
                    document.getElementById('update-id').value = client.id;
                    document.getElementById('update-name').value = client.name;
                    document.getElementById('update-email').value = client.email;
                    document.getElementById('update-message').value = client.message;
                    document.getElementById('update-client-form').style.display = 'block';
                }
            };
            xhr.onerror = function() {
                console.error('Request failed');
            };
            xhr.send();
        }

        // Menangani pengiriman formulir untuk memperbarui klien
        document.getElementById('update-client-form').addEventListener('submit', function(event) {
            event.preventDefault();

            var id = document.getElementById('update-id').value;
            var name = document.getElementById('update-name').value;
            var email = document.getElementById('update-email').value;
            var message = document.getElementById('update-message').value;

            var xhr = new XMLHttpRequest();
            xhr.open('PUT', 'http://localhost:8000/clients/' + id, true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.onload = function() {
                if (xhr.status >= 200 && xhr.status < 300) {
                    alert('Klien berhasil diperbarui!');
                    loadClients();
                    document.getElementById('update-client-form').style.display = 'none';
                }
            };
            xhr.onerror = function() {
                console.error('Request failed');
            };

            var data = JSON.stringify({ name: name, email: email, message: message });
            xhr.send(data);
        });

        // Fungsi untuk menghapus klien
        function deleteClient(id) {
            if (confirm('Apakah Anda yakin ingin menghapus klien ini?')) {
                var xhr = new XMLHttpRequest();
                xhr.open('DELETE', 'http://localhost:8000/clients/' + id, true);
                xhr.onload = function() {
                    if (xhr.status >= 200 && xhr.status < 300) {
                        alert('Klien berhasil dihapus!');
                        loadClients();
                    }
                };
                xhr.onerror = function() {
                    console.error('Request failed');
                };
                xhr.send();
            }
        }

        // Muat daftar klien saat halaman pertama kali dimuat
        loadClients();
    </script>
</body>
</html>
